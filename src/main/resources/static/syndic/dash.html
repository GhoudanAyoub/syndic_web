<!DOCTYPE html>
<html>

<head>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
    <script>
        $.ajax({
            url: '/api/sessions',
            type: 'GET',
            async: false,
            success: function (data,
                               textStatus, jqXHR) {

            },
            error: function (jqXHR, textStatus,
                             errorThrown) {
                location.href = "../index.html";
            }
        });
    </script>

    <!-- Basic Page Info -->
    <meta charset="utf-8">
    <title>Accueil</title>

    <!-- Site favicon -->
    <link rel="apple-touch-icon" sizes="180x180" href="../vendors/images/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="../vendors/images/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="../vendors/images/favicon-16x16.png">

    <!-- Mobile Specific Metas -->
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

    <!-- Google Font -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap"
          rel="stylesheet">
    <!-- CSS -->
    <link rel="stylesheet" type="text/css" href="../vendors/styles/core.css">
    <link rel="stylesheet" type="text/css" href="../vendors/styles/icon-font.min.css">
    <link rel="stylesheet" type="text/css" href="../src/plugins/datatables/css/dataTables.bootstrap4.min.css">
    <link rel="stylesheet" type="text/css" href="../src/plugins/datatables/css/responsive.bootstrap4.min.css">
    <link rel="stylesheet" type="text/css" href="../vendors/styles/style.css">
    <!-- Charts test  -->

    <script src="https://cdn.jsdelivr.net/npm/apexcharts"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.7.1/chart.min.js"></script>
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-119386393-1"></script>

    <script>

        window.dataLayer = window.dataLayer || [];

        function gtag() {
            dataLayer.push(arguments);
        }

        gtag('js', new Date());

        gtag('config', 'UA-119386393-1');
    </script>
</head>

<body>


<div class="header">
    <div class="header-left">
        <div class="menu-icon dw dw-menu"></div>
    </div>
    <div class="header-right">
        <div class="user-info-dropdown">
            <div class="dropdown">
                <a class="dropdown-toggle" href="#" role="button" data-toggle="dropdown">
							<span class="user-icon">
								<img style="width:52px;height:52px;" src="" onerror="this.src='images/no-image.png'"
                                     alt="" id="headerimg">
							</span>
                    <span class="user-name" id="headername">Username</span>
                </a>
                <div class="dropdown-menu dropdown-menu-right dropdown-menu-icon-list">
                    <a class="dropdown-item" href="profil.html"><i class="dw dw-user1"></i> Profil</a>
                    <a class="dropdown-item" href="changemdp.html"><i class="dw dw-padlock1"></i> Changement du mot de
                        passe</a>
                    <a class="dropdown-item" href="/logout"><i class="dw dw-logout"></i> Se déconnecter</a>
                </div>
            </div>
        </div>
    </div>
</div>


<div class="left-side-bar">
    <div class="brand-logo">
        <a href="dash.html">
            <img src="../vendors/images/deskapp-logo.svg" alt="" class="dark-logo">
            <img src="../vendors/images/SyndicLogo.png" alt="" class="light-logo">
        </a>
        <div class="close-sidebar" data-toggle="left-sidebar-close">
            <i class="ion-close-round"></i>
        </div>
    </div>
    <div class="menu-block customscroll">
        <div class="sidebar-menu">
            <ul id="accordion-menu">
                <li>
                    <a href="dash.html" class="dropdown-toggle no-arrow">
                        <span class="micon dw dw-house-1"></span><span class="mtext">Home</span>
                    </a>
                </li>
                <li>
                    <a href="immeubles.html" class="dropdown-toggle no-arrow">
                        <span class="micon dw dw-building"></span><span class="mtext">Immeubles</span>
                    </a>
                </li>
                <li>
                    <a href="appartements.html" class="dropdown-toggle no-arrow">
                        <span class="micon dw dw-door"></span><span class="mtext">Appartements</span>
                    </a>
                </li>
                <li>
                    <a href="residents.html" class="dropdown-toggle no-arrow">
                        <span class="micon dw dw-user-3"></span><span class="mtext">Résidents</span>
                    </a>
                </li>
                <li>
                    <a href="revenus.html" class="dropdown-toggle no-arrow">
                        <span class="micon dw dw-profits"></span><span class="mtext">Revenus</span>
                    </a>
                </li>
                <li>
                    <a href="depenses.html" class="dropdown-toggle no-arrow">
                        <span class="micon dw dw-loss"></span><span class="mtext">Dépenses</span>
                    </a>
                </li>
                <li>
                    <a href="categories.html" class="dropdown-toggle no-arrow">
                        <span class="micon dw dw-panel2"></span><span class="mtext">Catégories</span>
                    </a>
                </li>
                <li class="dropdown">
                    <a href="javascript:;" class="dropdown-toggle">
                        <span class="micon dw dw-notebook"></span><span class="mtext">Relevés</span>
                    </a>
                    <ul class="submenu">
                        <li><a href="relevesimmeubles.html">Par immeuble</a></li>
                        <li><a href="relevesappartements.html">Par appartement</a></li>
                    </ul>
                </li>
            </ul>
        </div>
    </div>
</div>
<div class="mobile-menu-overlay"></div>

<div class="main-container">
    <div class="pd-ltr-20">
        <div class="card-box pd-20 height-100-p mb-30">
            <div class="row align-items-center">
                <div class="col-md-3">

                    <img src="../vendors/images/OurLogo.png" alt="">
                </div>
                <div class="col-md-9">
                    <h4 class="font-20 weight-500 mb-10 text-capitalize">

                        <div class="weight-600 font-30 text-blue">La Copropriété En Ligne</div>
                    </h4>
                    <p class="font-18 max-width-600">La gestion de votre syndicat de copropriété devient plus simple
                        avec notre logiciel de gestion de copropriété.

                        Grâce à notre logiciel, la comptabilité de votre résidence deviendra un jeu d'enfant pour
                        vous.</p>
                </div>
            </div>
        </div>
        <div class="row">
            <div class="col-xl-6 mb-30">
                <div class="card-box height-100-p widget-style1">
                    <div class="d-flex flex-wrap align-items-center">
                        <div class="progress-data">
                            <img src="../vendors/images/immeubles.png" alt="" class="light-logo">
                        </div>
                        <div class="widget-data">

                            <div class="weight-600 font-14">Nombres Des immeubles</div>
                            <div id="immeubles" class="h4 mb-0"></div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-xl-6 mb-30">
                <div class="card-box height-100-p widget-style1">
                    <div class="d-flex flex-wrap align-items-center">
                        <div class="progress-data">
                            <img src="../vendors/images/residents.png" alt="" class="light-logo">
                        </div>
                        <div class="widget-data">

                            <div class="weight-600 font-14">Nombres Des Residents</div>
                            <div id="resident" class="h4 mb-0"></div>
                        </div>
                    </div>
                </div>
            </div>

        </div>
        <div class="row">
            <div class="col-xl-6 mb-30">
                <div class="card-box height-100-p pd-20">
                    <h2 class="h4 mb-20">Revenus</h2>
                    <!--<div id="chart5"></div>-->
                    <canvas id="revenus"></canvas>
                </div>
            </div>
            <div class="col-xl-6 mb-30">
                <div class="card-box height-100-p pd-20">
                    <h2 class="h4 mb-20">Depenses</h2>
                    <canvas id="depenses"></canvas>
                </div>
            </div>
        </div>

    </div>


</div>
<!-- js -->

<script src="../vendors/scripts/core.js"></script>
<script src="../vendors/scripts/script.min.js"></script>
<script src="../vendors/scripts/process.js"></script>
<script src="../vendors/scripts/layout-settings.js"></script>
<script src="../src/plugins/apexcharts/apexcharts.min.js"></script>
<script src="../src/plugins/datatables/js/jquery.dataTables.min.js"></script>
<script src="../src/plugins/datatables/js/dataTables.bootstrap4.min.js"></script>
<script src="../src/plugins/datatables/js/dataTables.responsive.min.js"></script>
<script src="../src/plugins/datatables/js/responsive.bootstrap4.min.js"></script>
<script src="../vendors/scripts/dashboard.js"></script>
<script src="../script/dash.js"></script>
<script src="script/home.js"></script>

<script>

    async function loadRevenus() {

        // fetch years
        const response = await fetch('http://localhost:9090/api/revenus/annee');
        const data = await response.json();

        //fetch montant
        const response1 = await fetch('http://localhost:9090/api/revenus/montant');
        const data1 = await response1.json();


        // get my chart
        const ctx = document.getElementById('revenus').getContext('2d');

        const myChart = new Chart(ctx, {
            type: 'bar',
            options: {
                indexAxis: 'y',
                backgroundColor: [
                    'rgba(255, 99, 132, 0.2)',  // Bar 1
                    'rgba(54, 162, 235, 0.2)',  // Bar 2
                    'rgba(255, 206, 86, 0.2)',  // Bar 3
                    'rgba(75, 192, 192, 0.2)',  // Bar 4
                    'rgba(153, 102, 255, 0.2)', // Bar 5
                    'rgba(255, 159, 64, 0.2)'   // Bar 6
                ],
                borderWidth: 2,

            },
            data: {
                labels: Object.values(data),
                datasets: [
                    {
                        label: 'Montant Des Revenus Par Annee',
                        data: Object.values(data1),
                    },
                ],
            },
        });
    }

    loadRevenus();


    //Depenses

    async function loadDepenses() {

        // fetch years
        const response = await fetch('http://localhost:9090/api/depenses/annee');
        const data = await response.json();

        //fetch montant
        const response1 = await fetch('http://localhost:9090/api/depenses/montant');
        const data1 = await response1.json();


        // get my chart
        const ctx = document.getElementById('depenses').getContext('2d');

        const myChart = new Chart(ctx, {
            type: 'bar',
            options: {

                backgroundColor: [
                    'rgba(75, 192, 192, 0.2)',  // Bar 4
                    'rgba(153, 102, 255, 0.2)', // Bar 5
                    'rgba(255, 159, 64, 0.2)'   // Bar 6
                ],
                borderWidth: 2,

            },
            data: {
                labels: Object.values(data),
                datasets: [
                    {
                        label: 'Montant Des Depenses Par Annee',
                        data: Object.values(data1),
                    },
                ],
            },
        });
    }

    loadDepenses();

    //nombreImmeuble
    async function nombreImmeuble() {

        // fetch years
        const response = await fetch('http://localhost:9090/api/immeubles/nbr');
        const data = await response.json();


        // get my chart
        const ctx = document.getElementById('immeubles').innerHTML = data;


    }


    nombreImmeuble();

    //


    async function nombreResident() {

        // fetch years
        const response = await fetch('http://localhost:9090/api/residents/nbr');
        const data = await response.json();


        // get my chart
        const ctx = document.getElementById('resident').innerHTML = data;


    }


    nombreResident();


    //Map
    function initMap() {
        // The location of Uluru
        const uluru = {lat: -25.344, lng: 131.031};
        // The map, centered at Uluru
        const map = new google.maps.Map(document.getElementById("map"), {
            zoom: 4,
            center: uluru,
        });
        // The marker, positioned at Uluru
        const marker = new google.maps.Marker({
            position: uluru,
            map: map,
        });
    }

    initMap();
    window.initMap = initMap;
</script>
</body>

</html>